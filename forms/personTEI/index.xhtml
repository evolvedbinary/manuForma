<!DOCTYPE html><html xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.w3.org/1999/xhtml" xmlns:sc="http://www.ascc.net/xml/schematron" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:tei="http://www.tei-c.org/ns/1.0" xmlns:srophe="https://srophe.app" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xf="http://www.w3.org/2002/xforms" xmlns:local="http://syriaca.org/ns">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
      <meta name="author" content="majlis-erc" />
      <meta name="description" content="Create and edit person records for MAJLIS: The Transformation of Jewish Literature in Arabic in the Islamicate World Record information pertaining the institutions and people behind the project. Add names in various forms and writings systems, biographical data, bibliographic references from the Zotero database and Linked Open Data references." />
      <title>Edit Person TEI records</title>
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" />
      <link rel="stylesheet" type="text/css" href="resources/bootstrap/css/bootstrap.min.css" />
      <link rel="stylesheet" type="text/css" href="resources/css/style.css" />
      <link rel="stylesheet" type="text/css" href="resources/css/xforms.css" /><script type="text/javascript" src="resources/bootstrap/js/bootstrap.min.js"></script><script type="text/javascript" src="resources/js/jquery.min.js"></script><script type="text/javascript" src="resources/js/jquery.validate.min.js"></script><script type="text/javascript" src="resources/js/login.js"></script><script type="text/javascript">
                    function getXMLDate(){
                    var d = new Date();
                    return d.toISOString();
                    }
                </script><xf:model id="m-mss">
         <xf:instance id="i-rec"><data></data></xf:instance>
         <xf:instance id="i-user" src="userInfo"></xf:instance>
         <xf:instance id="i-login"><data>
               <user></user>
               <password></password></data></xf:instance>
         <xf:instance id="i-admin">
            <TEI xmlns="http://www.tei-c.org/ns/1.0">
               <editor role="creator" ref=""></editor>
               <idno type="URI"></idno>
            </TEI>
         </xf:instance>
         <xf:instance id="i-projectSpecificData" src="forms/templates/editionStmtProjectOptions.xml"></xf:instance>
         <xf:instance id="i-projectSpecificDataSelected"><data>
               <selected id="" value="TEST"></selected></data></xf:instance>
         <xf:instance id="i-elementTemplate" src="forms/personTEI/templates/elementTemplate.xml"></xf:instance>
         <xf:instance id="i-attributeTemplate" src="forms/personTEI/templates/attributesTemplate.xml"></xf:instance>
         <xf:instance id="i-availableElements" src="forms/personTEI/templates/elementTemplate.xml"></xf:instance>
         <xf:instance id="i-upload">
            <xml-base64 xsi:type="xs:base64Binary"></xml-base64>
         </xf:instance>
         <xf:instance id="i-search"><data><q></q></data></xf:instance>
         <xf:instance id="i-search-results"><data></data></xf:instance>
         <xf:instance id="i-selected-search"><data></data></xf:instance>
         <xf:instance id="i-selected"><data></data></xf:instance>
         <xf:instance id="i-selectTemplate"><data><template name="Generic Persons Template" src="/forms/templates/persons-fulltemplate.xml"></template></data></xf:instance>
         <xf:instance id="i-subforms"><data>
               <subform formName="titleStmt" selected="false"></subform>
               <subform formName="listPersons" selected="false"></subform></data></xf:instance>
         <xf:instance id="i-submission">
            <response status="success">
               <message>Submission result</message>
            </response>
         </xf:instance>
         <xf:instance id="i-insert-elements">
            <TEI xmlns="http://www.tei-c.org/ns/1.0">
               <element></element>
            </TEI>
         </xf:instance>
         <xf:instance id="i-insert-attributes">
            <TEI xmlns="http://www.tei-c.org/ns/1.0">
               <attribute></attribute>
            </TEI>
         </xf:instance>
         <xf:instance id="i-submission-params">
            <recordManagement xmlns="">
               
               <saveOptions>
                  
                  <option name="github" enable="true">
                     
                     <parameter name="githubRepoName">majlis-data</parameter>
                     
                     <parameter name="githubPath">data/persons/tei/</parameter>
                     
                     <parameter name="githubOwner">majlis-erc</parameter>
                     
                     <parameter name="githubBranch">main</parameter>
                     </option>
                  
                  <option name="exist-db" enable="true">
                     
                     <parameter name="eXistCollection">/db/apps/majlis-data/data/persons/tei</parameter>
                     </option>
                  
                  <option name="download" enable="true"></option>
                  </saveOptions>
               
               <retrieveOptions>
                  
                  <option name="exist-db" enable="true">
                     
                     <parameter name="eXistCollection">/db/apps/majlis-data/data/persons/tei</parameter>
                     </option>
                  </retrieveOptions>
               </recordManagement>
         </xf:instance>
         <xf:instance id="i-move"><data xmlns="">
               <tmp></tmp></data></xf:instance>
         <xf:instance id="i-repeatIndex"><data xmlns="">
               <index>1</index></data></xf:instance>
         <xf:instance id="i-prettyPrint" src="forms/formGenerator/prettyPrint.xsl"></xf:instance>
         <xf:instance id="i-preview"><data></data></xf:instance>
         <xf:submission id="s-load-template" method="post" ref="instance('i-selected')" replace="instance" instance="i-rec" serialization="none" mode="synchronous">
            <xf:resource value="concat('services/get-rec.xql?template=true&amp;path=',instance('i-selected'))"></xf:resource>
            <xf:action ev:event="xforms-submit-done">
               <xf:message level="modeless"> Data Loaded! </xf:message>
               <xf:insert ref="instance('i-rec')//*:titleStmt/child::*" at="last()" origin="instance('i-admin')//*:editor" position="after"></xf:insert>
               <xf:setvalue ref="instance('i-rec')//*:titleStmt/*:editor[last()]" value="instance('i-user')//*:fullName"></xf:setvalue>
               <xf:setvalue ref="instance('i-rec')//*:titleStmt/*:editor[last()]/@xml:id" value="instance('i-user')//*:user"></xf:setvalue>
               <xf:insert ref="instance('i-rec')//*:revisionDesc/child::*" at="last()" origin="instance('i-admin')//*:change[1]" position="after"></xf:insert>
               <xf:setvalue ref="instance('i-rec')//*:revisionDesc/*:change[last()]" value="concat('Record created by manuForma, editor: ', instance('i-user')//*:fullName)"></xf:setvalue>
               <xf:setvalue ref="instance('i-rec')//*:revisionDesc/*:change[last()]/@who" value="concat('#',instance('i-user')//*:user)"></xf:setvalue>
               <xf:setvalue ref="instance('i-rec')//*:revisionDesc/*:change[last()]/@when" value="getXMLDate()"></xf:setvalue>
            </xf:action>
            <xf:message level="modeless" ev:event="xforms-submit-error"> Submit error. </xf:message>
         </xf:submission>
         <xf:submission id="s-load-template-search" method="post" ref="instance('i-selected-search')" replace="instance" instance="i-rec" serialization="none" mode="synchronous">
            <xf:resource value="concat('services/get-rec.xql?template=true&amp;path=',instance('i-selected-search'))"></xf:resource>
            <xf:message level="modeless" ev:event="xforms-submit-done"> Data Loaded! </xf:message>
            <xf:message level="modeless" ev:event="xforms-submit-error"> Submit error. </xf:message>
         </xf:submission>
         <xf:submission id="s-search-saved" method="post" ref="instance('i-search')" replace="instance" instance="i-search-results" serialization="none" mode="synchronous">
            <xf:resource value="concat('services/get-rec.xql?search=true&amp;q=',instance('i-search'),'&amp;eXistCollection=',string(instance('i-submission-params')//*:retrieveOptions/*:option[@name='exist-db']/*:parameter[@name='eXistCollection']))"></xf:resource>
            <xf:message level="modeless" ev:event="xforms-submit-error"> Submit error. </xf:message>
         </xf:submission>
         <xf:submission id="s-browse-saved" method="post" ref="instance('i-search')" replace="instance" instance="i-search-results" serialization="none" mode="synchronous">
            <xf:resource value="concat('services/get-rec.xql?search=true&amp;view=all&amp;eXistCollection=',string(instance('i-submission-params')//*:retrieveOptions/*:option[@name='exist-db']/*:parameter[@name='eXistCollection']))"></xf:resource>
            <xf:message level="modeless" ev:event="xforms-submit-error"> Submit error. </xf:message>
         </xf:submission>
         <xf:submission id="s-post-to-update" action="services/upload.xql" ref="instance('i-upload')" replace="instance" instance="i-rec" method="post">
            <xf:message level="modeless" ev:event="xforms-submit-done"> Data Loaded! </xf:message>
            <xf:message level="modeless" ev:event="xforms-submit-error"> Submit error. </xf:message>
         </xf:submission>
         <xf:submission id="s-download-xml" ref="instance('i-rec')" show="new" method="post" replace="all" action="form.xq?form=services/download.xml?type=download"></xf:submission>
         <xf:submission id="s-view-xml" ref="instance('i-rec')" show="new" method="post" replace="instance" instance="i-submission" action="services/submit.xql?type=view"></xf:submission>
         <xf:submission id="s-view-html" ref="instance('i-rec')" show="new" replace="all" instance="i-submission" method="post" action="services/submit.xql?type=previewHTML"></xf:submission>
         <xf:submission id="s-save" ref="instance('i-rec')" replace="instance" instance="i-submission" method="post">
            <xf:resource value="concat('services/submit.xql?type=save&amp;eXistCollection=',string(instance('i-submission-params')//*:saveOptions/*:option[@name='exist-db']/*:parameter[@name='eXistCollection']))"></xf:resource>
            <xf:action ev:event="xforms-submit-done">
               <xf:message ref="instance('i-submission')//*:message"></xf:message>
            </xf:action>
            <xf:action ev:event="xforms-submit-error">
               <xf:message ref="instance('i-submission')//*:message"></xf:message>
            </xf:action>
         </xf:submission>
         <xf:submission id="s-github" ref="instance('i-rec')" replace="instance" instance="i-submission" method="post">
            <xf:resource value="concat('services/submit.xql?type=github&amp;githubRepoName=',string(instance('i-submission-params')//*:parameter[@name='githubRepoName']),'&amp;githubPath=',string(instance('i-submission-params')//*:parameter[@name='githubPath']),'&amp;githubOwner=',string(instance('i-submission-params')//*:parameter[@name='githubOwner']),'&amp;githubBranch=',string(instance('i-submission-params')//*:parameter[@name='githubBranch']))"></xf:resource>
            <xf:action ev:event="xforms-submit-done">
               <xf:message ref="instance('i-submission')//*:message"></xf:message>
            </xf:action>
            <xf:action ev:event="xforms-submit-error">
               <xf:message ev:event="xforms-submit-error" level="modal">Unable to submit your additions at this time, you may download your changes and email
                  them to us.</xf:message>
            </xf:action>
         </xf:submission>
      </xf:model>
   </head>
   <body>
      <header>
         <nav class="navbar navbar-expand-md navbar-dark bg-dark">
            <div class="container-fluid"><a class="navbar-brand col-md-3 col-lg-2 me-0 px-3" href="/exist/apps/manuForma/">manuForma</a><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarCollapse">
                  <ul class="navbar-nav me-auto mb-2 mb-md-0">
                     <li class="nav-item"><a class="nav-link active" aria-current="page" href="/exist/apps/manuForma/">Home</a></li>
                     <li class="nav-item"><a class="nav-link" href="#">About</a></li>
                     <li class="nav-item"><a class="nav-link disabled">Documentation</a></li>
                  </ul><span class="d-flex" role="search" id="userInfo">
                     <ul class="nav navbar-nav">
                        <li>
                           <p class="navbar-btn"><xf:output xmlns="http://www.w3.org/2002/xforms" value="instance('i-user')//*:user" class="btn btn-sm btn btn-outline-light"></xf:output></p>
                        </li>
                     </ul></span></div>
            </div>
         </nav>
      </header>
      <div class="container-fluid">
         <div class="row">
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
               <div class="position-sticky pt-3">
                  <ul class="nav flex-column">
                     <li class="nav-item">
                        <xf:trigger appearance="minimal" class="nav-link"><xf:label><span data-feather="home"></span> Main Page  </xf:label><xf:action ev:event="DOMActivate">
                              <xf:toggle case="view-main-entry"></xf:toggle>
                           </xf:action>
                        </xf:trigger>
                     </li>
                     <li class="nav-item">
                        <xf:trigger appearance="minimal" ref="instance('i-subforms')//*:subform[@formName = 'listPersons']" class="nav-link"><xf:label>Person</xf:label><xf:action ev:event="DOMActivate">
                              <xf:toggle case="view-data-entry"></xf:toggle>
                              <xf:unload targetid="subform"></xf:unload>
                              <xf:setvalue ref="instance('i-subforms')//*:subform[@selected = 'true']/@selected" value="'false'"></xf:setvalue>
                              <xf:load if="@selected != 'true'" show="embed" targetid="subform" resource="form.xq?form=forms/personTEI/listPersons.xhtml"></xf:load>
                              <xf:setvalue ref="@selected" value="'true'"></xf:setvalue>
                              <setvalue xmlns="http://www.w3.org/2002/xforms" ref="instance('i-repeatIndex')/index" value="1"></setvalue>
                           </xf:action>
                        </xf:trigger>
                     </li>
                     <xf:repeat ref="instance('i-rec')//descendant::*:listPerson/*:person[position() &gt; 1]" id="navRepeatlistPersons">
                        <li class="nav-item">
                           <xf:trigger appearance="minimal" class="nav-link"><xf:label>Person  [<xf:output value="position() + 1"></xf:output>]</xf:label><xf:action ev:event="DOMActivate">
                                 <xf:toggle case="view-data-entry"></xf:toggle>
                                 <xf:unload targetid="subform"></xf:unload>
                                 <xf:setvalue ref="instance('i-subforms')//*:subform[@selected = 'true']/@selected" value="'false'"></xf:setvalue>
                                 <xf:load if="@selected != 'true'" show="embed" targetid="subform" resource="form.xq?form=forms/personTEI/listPersons.xhtml"></xf:load>
                                 <xf:setvalue ref="@selected" value="'true'"></xf:setvalue>
                                 <setvalue xmlns="http://www.w3.org/2002/xforms" ref="instance('i-repeatIndex')/index" value="index('navRepeatlistPersons') + 1"></setvalue>
                              </xf:action>
                           </xf:trigger>
                        </li>
                     </xf:repeat>
                  </ul>
               </div>
            </nav>
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
               <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 border-bottom">
                  <h1 class="h2">
                     Edit Record: <xf:output value="instance('i-rec')//*:titleStmt/*:title[@level='a']" class="elementLabel"></xf:output></h1>
                  <div class="btn-toolbar mb-2 mb-md-0">
                     <div class="btn-group me-2">
                        <div class="submission float-end">
                           <xf:trigger appearance="minimal" class="btn btn-outline-secondary btn-sm"><xf:label><span data-feather="home"></span> Admin Metadata  </xf:label><xf:action ev:event="DOMActivate">
                                 <xf:toggle case="view-admin"></xf:toggle>
                              </xf:action>
                           </xf:trigger>
                           <xf:trigger appearance="minimal" ref="instance('i-subforms')//*:subform[@formName = 'titleStmt']" class="btn btn-outline-secondary btn-sm"><xf:label>Header</xf:label><xf:action ev:event="DOMActivate">
                                 <xf:toggle case="view-data-entry"></xf:toggle>
                                 <xf:unload targetid="subform"></xf:unload>
                                 <xf:setvalue ref="instance('i-subforms')//*:subform[@selected = 'true']/@selected" value="'false'"></xf:setvalue>
                                 <xf:load if="@selected != 'true'" show="embed" targetid="subform" resource="form.xq?form=forms/personTEI/titleStmt.xhtml"></xf:load>
                                 <xf:setvalue ref="@selected" value="'true'"></xf:setvalue>
                                 <setvalue xmlns="http://www.w3.org/2002/xforms" ref="instance('i-repeatIndex')/index" value="1"></setvalue>
                              </xf:action>
                           </xf:trigger>
                           <xf:submit class="btn btn-outline-secondary btn-sm" submission="s-view-html" appearance="minimal"><xf:label> Preview HTML</xf:label></xf:submit>
                           <xf:submit class="btn btn-outline-secondary btn-sm" submission="s-github" appearance="minimal"><xf:label> Submit to GitHub </xf:label></xf:submit>
                           <xf:submit class="btn btn-outline-secondary btn-sm" submission="s-download-xml" appearance="minimal"><xf:label> Download XML (Chrome only)</xf:label></xf:submit>
                        </div>
                     </div>
                  </div>
               </div>
               <p class="alert alert-light hint">Create and edit person records for MAJLIS: The Transformation of Jewish Literature
                  in Arabic in the Islamicate World</p>
               <xf:switch id="edit" class="mainContent panel">
                  <xf:case id="view-main-entry" selected="true()">
                     <div class="accordion" id="loadRecords">
                        <div class="accordion-item">
                           <h2 class="accordion-header" id="headingProjectMetadata"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseProjectMetadata" aria-expanded="false" aria-controls="collapseProjectMetadata">
                                 Assign project metadata
                                 </button></h2>
                           <div id="collapseProjectMetadata" class="accordion-collapse collapse" aria-labelledby="headingProjectMetadata" data-bs-parent="#loadRecords">
                              <div class="accordion-body">
                                 <hr />
                                 <h4>Select project</h4>
                                 <xf:select1 ref="instance('i-projectSpecificDataSelected')//*:selected" class="elementSelect">
                                    <xf:itemset ref="instance('i-projectSpecificData')//*:option"><xf:label ref="@name"></xf:label><xf:value ref="@name"></xf:value>
                                    </xf:itemset>
                                 </xf:select1>
                                 <xf:trigger class="btn btn-outline-secondary btn-sm controls add" appearance="full"><xf:label>Load project metadata</xf:label><xf:delete ev:event="DOMActivate" ref="instance('i-rec')//*:editionStmt"></xf:delete>
                                    <xf:insert ev:event="DOMActivate" ref="instance('i-rec')//*:titleStmt" at="." origin="instance('i-projectSpecificData')//*:option[@name = instance('i-projectSpecificDataSelected')//*:selected]/descendant-or-self::*:editionStmt" position="after"></xf:insert>
                                    <xf:message level="modeless" ev:event="DOMActivate"> Added </xf:message>
                                 </xf:trigger>
                                 <hr />
                              </div>
                           </div>
                        </div>
                        <div class="accordion-item">
                           <h2 class="accordion-header" id="headingExistingRecord"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExistingRecord" aria-expanded="false" aria-controls="collapseExistingRecord">
                                 Continue work with existing record
                                 </button></h2>
                           <div id="collapseExistingRecord" class="accordion-collapse collapse" aria-labelledby="headingExistingRecord" data-bs-parent="#loadRecords">
                              <div class="accordion-body">
                                 <div class="fileLoading">
                                    <div class="input-group mb-3"><xf:input class="form-control" ref="instance('i-search')" incremental="true"><xf:label></xf:label></xf:input><xf:submit class="btn btn-outline-secondary" submission="s-search-saved" appearance="minimal"><xf:label> Search </xf:label></xf:submit>
                                       <xf:submit class="btn btn-outline-secondary" submission="s-browse-saved" appearance="minimal"><xf:label> Browse </xf:label></xf:submit>
                                    </div>
                                    <div class="input-group mb-3">
                                       <xf:select1 xmlns="http://www.w3.org/2002/xforms" appearance="full" class="checkbox select-group form-control" ref="instance('i-selected-search')"><xf:label></xf:label><xf:itemset ref="instance('i-search-results')//*:record"><xf:label ref="@name"></xf:label><xf:value ref="@src"></xf:value>
                                          </xf:itemset>
                                       </xf:select1>
                                       <xf:submit class="btn btn-outline-secondary" submission="s-load-template-search" appearance="minimal"><xf:label> Load selected record </xf:label></xf:submit>
                                    </div>
                                 </div>
                              </div>
                           </div>
                        </div>
                        <div class="accordion-item">
                           <h2 class="accordion-header" id="headingNewRecord"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseNewRecord" aria-expanded="false" aria-controls="collapseNewRecord">
                                 New record / Upload record
                                 </button></h2>
                           <div id="collapseNewRecord" class="accordion-collapse collapse" aria-labelledby="headingNewRecord" data-bs-parent="#loadRecords">
                              <div class="accordion-body">
                                 <div class="fileLoading">
                                    <h4 class="h6">Upload record <small class="text-muted">(from your computer)</small></h4>
                                    <div class="input-group mb-3">
                                       <xf:upload class="form-control" ref="instance('i-upload')" appearance="minimal"><xf:label></xf:label></xf:upload>
                                       <xf:submit submission="s-post-to-update" class="btn btn-outline-secondary" appearance="minimal"><xf:label>Load record</xf:label></xf:submit>
                                    </div>
                                 </div>
                                 <div class="fileLoading">
                                    <div class="input-group mb-3">
                                       <xf:select1 xmlns="http://www.w3.org/2002/xforms" class="form-control" ref="instance('i-selected')"><xf:label></xf:label><xf:itemset ref="instance('i-selectTemplate')//*:template"><xf:label ref="@name"></xf:label><xf:value ref="@src"></xf:value>
                                          </xf:itemset>
                                       </xf:select1>
                                       <xf:submit class="btn btn-outline-secondary" submission="s-load-template" appearance="minimal"><xf:label> Load template file </xf:label></xf:submit>
                                    </div>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                  </xf:case>
                  <xf:case id="view-admin">
                     <xf:repeat ref="instance('i-rec')//*:titleStmt/*:editor[@role='creator']">
                        <div class="input-group mb-3"><xf:input ref="." class="form-control"><xf:label>Creator: </xf:label><xf:alert>Add your name</xf:alert></xf:input><xf:trigger xmlns="http://www.w3.org/2002/xforms" appearance="minimal" class="btn controls remove inline"><xf:label><i xmlns="http://www.w3.org/1999/xhtml" class="bi bi-x-circle"></i></xf:label><xf:delete ev:event="DOMActivate" ref="."></xf:delete>
                           </xf:trigger>
                        </div>
                        <div class="input-group mb-3"><xf:input ref="@ref" class="form-control"><xf:label>Ref: </xf:label></xf:input></div>
                        <hr />
                     </xf:repeat>
                     <xf:trigger class="btn btn-outline-secondary btn-sm controls add" appearance="full"><xf:label><i class="bi bi-plus-circle"></i> Add Creator</xf:label><xf:insert ev:event="DOMActivate" ref="instance('i-rec')//*:titleStmt/child::*" at="last()" origin="instance('i-admin')//*:editor" position="after"></xf:insert>
                     </xf:trigger><br /><div class="input-group mb-3"><xf:input ref="instance('i-rec')//*:publicationStmt[1]/*:idno[@type='URI']" class="form-control"><xf:label>URI: </xf:label><xf:alert>* Use the following URI pattern: https://jalit.org/COLLECTION/UNIQUE_ID/tei</xf:alert></xf:input></div>
                  </xf:case>
                  <xf:case id="view-data-entry">
                     <xf:group ref="instance('i-rec')">
                        <xf:group id="subform"></xf:group>
                     </xf:group>
                  </xf:case>
                  <xf:case id="view-html">
                     <div class="htmlPreview"></div>
                  </xf:case>
               </xf:switch>
            </main>
         </div>
      </div>
   </body>
</html>