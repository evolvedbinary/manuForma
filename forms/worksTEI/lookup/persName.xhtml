<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:sc="http://www.ascc.net/xml/schematron" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:tei="http://www.tei-c.org/ns/1.0" xmlns:srophe="https://srophe.app" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xf="http://www.w3.org/2002/xforms" xmlns:local="http://syriaca.org/ns">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
      <meta charset="utf-8"/>
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
      <meta name="author" content="majlis-erc"/>
      <meta name="description" content="Create and edit Place records for MAJLIS: The Transformation of Jewish Literature in Arabic in the Islamicate World. Record title information"/>
      <title>Controlled Vocabulary Form for Edit Works TEI records</title>
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css"/>
      <link rel="stylesheet" type="text/css" href="resources/bootstrap/css/bootstrap.min.css"/>
      <link rel="stylesheet" type="text/css" href="resources/css/style.css"/>
      <link rel="stylesheet" type="text/css" href="resources/css/xforms.css"/><script type="text/javascript" src="resources/js/jquery.min.js"/><script type="text/javascript" src="resources/bootstrap/js/bootstrap.min.js"/><xf:model id="m-lookup">
         <xf:instance id="i-rec">
            <data/>
         </xf:instance>
         <xf:instance id="i-lookup-query">
            <data xmlns="">
               <q/>
            </data>
         </xf:instance>
         <xf:instance id="i-lookup-results">
            <data xmlns=""/>
         </xf:instance>
         <xf:instance id="i-lookup-selected">
            <data xmlns="">
               <selected/>
            </data>
         </xf:instance>
         <xf:instance id="i-lookup-add">
            <data xmlns=""/>
         </xf:instance>
         <xf:submission id="s-lookup" method="get" replace="instance" instance="i-lookup-results" serialization="none" mode="synchronous">
            <xf:resource value="concat('http://44.192.15.2/exist/apps/majlis/api/search/persName?format=xml&amp;q=', instance('i-lookup-query')//q),"/>
         </xf:submission>
      </xf:model>
   </head>
   <body>
      <div class="d-flex flex-column justify-content-center align-items-center">
         <h2 class="h3 mainElement">Look up persons</h2>
         <p>Search controlled vocabulary  
            <xf:output value="local-name(current())"/>
         </p>
         <div class="input-group">
            <xf:input id="search-q" ref="instance('i-lookup-query')/q" incremental="true">
               <xf:label/>
               <xf:toggle ev:event="DOMFocusIn" case="show-autocompletion"/>
            </xf:input>
            <xf:submit class="btn btn-outline-secondary btn-sm" submission="s-lookup" appearance="minimal">
               <xf:label><i class="bi bi-search"/></xf:label>
            </xf:submit>
         </div>
         <xf:select1 ref="instance('i-lookup-selected')/child::*" appearance="full" class="checkbox select-group">
            <xf:itemset ref="instance('i-lookup-results')//*:title/child::*[1]">
               <xf:label ref="."/>
               <xf:value ref="."/>
            </xf:itemset>
            <xf:action ev:event="xforms-value-changed">
               <xf:insert ev:event="DOMActivate" ref="instance('i-lookup-add')/child::*" origin="instance('i-lookup-results')//*:title/child::*[1][. = instance('i-lookup-selected')//selected]"/>
            </xf:action>
         </xf:select1>
         <xf:trigger class="btn btn-outline-secondary btn-sm" appearance="full" ref=".">
            <xf:label><i class="bi bi-plus-circle"/> Add to Record
            </xf:label>
            <xf:insert ev:event="DOMActivate" ref="." at="." origin="instance('i-lookup-selected')/selected/child::*" position="after"/>
            <xf:delete ev:event="DOMActivate" ref="."/>
            <xf:setvalue ref="instance('i-lookup-query')/q" value="''"/>
            <xf:delete ref="instance('i-lookup-results')//child::*"/>
            <xf:delete ref="instance('i-lookup-selected')//child::*"/>
            <xf:message level="modeless" ev:event="DOMActivate"> Added </xf:message>
         </xf:trigger>
      </div>
   </body>
</html>